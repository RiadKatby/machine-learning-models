هل يصنع المال السعادة؟
للإجابة على هذا السؤال سنقوم بجلب بيانات مؤشر الحياة الأفضل من [موقع](https://stats.oecd.org/index.aspx?DataSetCode=BLI) منظمة التعاون الاقتصادي والتنمية، وسنجلب ايضاً احصائيات حول نصيب الفرد من الناتج المحلي الإجمالي من [موقع](https://www.imf.org/en/Publications/SPROLLS/world-economic-outlook-databases) صندوق النقد الدولي. ثم سنقوم بجمع الجداول على بعضها ونرتب النتيجة حسب عمود نصيب الفرد من الناتج المحلي الإجمالي، ستجد في الجدول 1-1 جزءاً من الجدول الأخير.

![الجدول 1-1 هل يجعل المال الناس أكثر سعادة](assets\table-1-1.jpg)

هذا رسم بياني لمجموعة صغيرة وعشوائية من البلاد الشكل 1-17
![الشكل 1-17 لاحظ اتجاه البيانات في الشكل](assets\figure-1-17.jpg)

دقق في الرسم البياني لتجد اتجاه خطياً عاماً للبيانات على الرغم من وجود بعض الضوضاء (أي ان البيانات عشوائية جزئياً بالنسبة لخط مستقيم) ويبدو أن الرضا عن الحياة يرتفع بشكل خطي إلى حد ما مع زيادة نصيب الفرد من الناتج المحلي الاجمالي في البلاد. لذلك قررنا أن ننمذج الرضا عن الحياة كدالة خطية مع نصيب الفرد من الناتج المحلي الاجمالي، تسمى هذه الخطوة اختيار النموذج، حيث قمنا باختيار نموذجاً خطياً للرضا عن الحياة بميزة واحدة فقط هي نصيب الفرد من الناتج المحلي الاجمالي، إنظر المعادلة 1-1

المعادلة 1-1 نموذج خطي بسيط
$جودة_الحياة = theta_0 + theta_1 * نصيب_الفرد_من_الناتج_المحلي_الاجمالي$

يحتوي هذا النموذج على معاملين (برامترين) $theta_0 theta_1$[^1]، ويمكننا نمذجة أي خط مستقيم من خلال تعديل هذين المعاملين، إنظر النموذج 1-18

![الشكل 1-18 بعض النماذج الخطية الممكنة](assets\figure-1-18.jpg)

نحتاج ان نحدد افضل قيم لمعاملي النموذج قبل استخدامه، لكن السؤال هو كيف يمكننا تحديد هذه القيم بأفضل طريقة ممكن، يأتي الجواب من تحديد مقياس الأداء. ولتحديد هذا المقياس نستطيع الإعتماد على **دالة المنفعة** والتي تقيس مدى جودة النموذج، أو الاعتماد على **دالة التكلفة** التي تقيم مدى سوء النموذج. يستخدم العلماء لمشاكل الانحدار الخطي عادة دالة التكلفة التي تقيس المسافة بين تنبؤات النموذج الخطي وأمثلة التدريب الحقيقة، عندها يكون الهدف هو تقليل هذه المسافات إلى الحد الأدنى.

يأتي دور خوارزمية الانحدار الخطي الآن، حيث نقوم بإعطائها أمثلة التدريب الحقيقة وتقوم هي بإيجاد النموذج الخطي الأنسب لتلك البيانات. هل لاحظت الفرق بين الخوارزمية والنموذج؟ فخوارزمية الانحدار الخطي هي مجموعة الخطوات التي نسلكها لإيجاد أفضل قيم (تدريب الآلة) لمعاملي الخط المستقيم $theta_0 theta_1$ بينما النموذج هو قيم هذه المعاملات التي وجدناها. وجدت الخوارزمية أن القيم الأنسب هي $theta_0=4.85 theta_1=4.91*10^-5$

إنظر الشكل 1-19 لترى كيف أن الخط المستقيم المرسوم يتناسب مع اتجاه البيانات العام، ويمثل هذا الاتجاه بشكل مقبول.

![الشكل 1-19 النموذج الخطي الذي يناسب بيانات التدريب بأفضل شكل](assets\figure-1-19.jpg)

  نحن جاهزون الآن لتشغيل النموذج وتوليد التنبؤات، كمثال لنفترض أننا نريد معرفة درجة رضا القبراصة عن حياتهم، وأن بيانات منظمة التعاون الاقتصادي والتنمية لا تحتوي الإجابة.

نستطيع التنبؤ برضا القبارصة بجودة معقولة باستخدام نموذجنا الخطي: نبحث عن نصيب القبرصي من الناتج المحلي الاجمالي، فنجده 22,587 دولاراً، نعوض هذه القيمة في المعادلة الخطية لنجد رضا القبارصة عن حياتهم بحلها $4.85 + 22,587 × 4.91 × 10-5 = 5.96$

إنظر إلى الكود 1-1 لإشباع فضولك، فهو يقوم بتحميل البيانات، ويحضرها لتدريب النموذج[^2]، ثم يرسم شكلاً بيانياً للبيانات ليعطينا تصوراً عنها، ثم يدرب النموذج الخطي، ويتنبئ بالرضا عن الحياة بالنهاية[^3].

```pyton
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import sklearn.linear_model

# Load the data
oecd_bli = pd.read_csv("oecd_bli_2015.csv", thousands=',')
gdp_per_capita = pd.read_csv("gdp_per_capita.csv",thousands=',',delimiter='\t', encoding='latin1', na_values="n/a")

# Prepare the data
country_stats = prepare_country_stats(oecd_bli, gdp_per_capita)
X = np.c_[country_stats["GDP per capita"]]
y = np.c_[country_stats["Life satisfaction"]]

# Visualize the data
country_stats.plot(kind='scatter', x="GDP per capita", y='Life satisfaction')
plt.show()

# Select a linear model
model = sklearn.linear_model.LinearRegression()

# Train the model
model.fit(X, y)

# Make a prediction for Cyprus
X_new = [[22587]] # Cyprus' GDP per capita
print(model.predict(X_new)) # outputs [[ 5.96242338]]
```
المثال 1-1 تدريب وتشغيل نموذج خطي باستخدم Scikit-Learn

إذا استخدمنا خوارزمية تعليم قائمة على المثال بدلاً من تلك القائمة على النموذج، فسنجد أن سلوفينيا لديها أقرب نصيب للفرد من الناتج المحلي الاجمالي لقبرص 20,732 دولاراً، وبما أن بيانات منظمة التعاون الاقتصادي والتنمية تخبرنا أن رضا السلوفينيين عن الحياة هو 5,7 فقد يكون تنبؤ رضا القبارصة عن حياتهم هو 5,7. إذا قمنا بالتصغير قليلاً لننظر إلى أقرب بلدين تاليين، فسنجد البرتغال واسبانيا مع قيم رضا عن الحياة 5,1 و 6,5 على التوالي، وعند حساب متوسط هذه القيم نحصل على 5,77 وهو قريب جداً من التوقعنا بناء على النموذج. تسمى هذه الخوارزمية البسيطة إنحدار الجيران الأقرب المعدودة في هذا المثال عددنا 3 جيران فقط أي k=3. لتجربة هذا النموذج قم باستبدال نموذج الانحدار الخطي بإنحدار الجيران الأقرب المعدودة في الكود السابق كما يلي

استبدل هذين السطرين
```python
import sklearn.linear_model
model = sklearn.linear_model.LinearRegression()
```
بهذين السطرين
```python
import sklearn.neighbors
model = sklearn.neighbors.KNeighborsRegressor(n_neighbors=3)
```
إذا سارت الأمور على مايرام فسيقوم النموذج بعمل تنبؤات جيدة، وإلا فقد نحتاج إلى استخدام المزيد من الميزات (مثل معدل التوظيف، الصحة، تلوث الهواء، إلخ) أو قد نحتاج إلى بيانات تدريب أكثر أو أجود، أو ربما نحتاج إلى نموذج أقوى على سبيل المثال نموذج انحدار متعدد الحدود.

ملخص ما عملنا عليه
* دراسنا بيانات التدريب
* حددنا النموذج المناسب
* دربنا النموذج على بيانات التدريب (حيث بحثت الخوارزمية عن قيم معاملات النموذج التي تجعل دالة الكلفة بأقل قيمة ممكنة)
* استخدمنا النموذج لعمل التنبؤات على الحالات الجديدة (هذا ما يسمى بالاستدلال) على أمل أن يتم تعميم النموذج بشكل جيد.

هذا مايبدو عليه مشروع تعلم الآلة النموذج باختصار، وسنتعلم عنه لاحقاً بالتفصيل عن تنفيذ مشروع كامل

قمنا بتغطية الكثير من الجوانب حتى الآن فنحن نعرف الآن ما يعنيه أن الآلة تتعلم حقيقة، ولماذ يكون مفيداً أن تتعلم الآلة، وما هي أنوع تعلم الآلة الأكثر شيوعاً، وكيف يبدو سير عمل المشروع تعلم الآلة النموذجي.
وسنتعلم لاحقاً عن التحديات التي قد نواجهها في تعليم الآلة والتي قد تمنعنا من اجراء تنبؤات دقيقة.


[^1]: يستخدم غالباً الحرف الاغريقي $theta$ لتمثيل معاملات النموذج اصطلاحاً.
[^2]: لا يحتوي هذا الكود على الدالة `prepare_country_stats()` ستجد في الملحقات كود Pandas ممل يجمع بيانات رضا الحياة ونصيب الفرد من الناتج المحلي الاجمالي
[^3]: هون على نفسك إذا لم تفهم الكود كاملاً، سنتعلم عن Scikit-Learn أكثر فيما بعد